<?xml version="1.0" encoding="utf-8"?>
<widget id="mendix.detailswidget.Detailswidget" pluginWidget="true" needsEntityContext="true" offlineCapable="true"
        supportedPlatform="Web"
        xmlns="http://www.mendix.com/widget/1.0/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.mendix.com/widget/1.0/ ../node_modules/mendix/custom_widget.xsd">
    <name>Detailswidget</name>
    <description>Widget de détails pour la consommation énergétique</description>
    <icon/>
    <properties>
        <propertyGroup caption="General">
            <propertyGroup caption="Configuration">
                <property key="devMode" type="boolean" defaultValue="false">
                    <caption>Mode développeur</caption>
                    <description>Activer le mode développeur pour simuler les données (sans avoir besoin de mapper des attributs réels)</description>
                </property>
                <property key="viewMode" type="enumeration" defaultValue="energetic">
                    <caption>Mode de visualisation</caption>
                    <description>Choisir entre le mode énergétique ou IPE</description>
                    <enumerationValues>
                        <enumerationValue key="energetic">Énergétique</enumerationValue>
                        <enumerationValue key="ipe">IPE</enumerationValue>
                    </enumerationValues>
                </property>

                <property key="energyType" type="enumeration" defaultValue="electricity">
                    <caption>Type d'énergie</caption>
                    <description>Sélectionner le type d'énergie à afficher</description>
                    <enumerationValues>
                        <enumerationValue key="electricity">Électricité</enumerationValue>
                        <enumerationValue key="gas">Gaz</enumerationValue>
                        <enumerationValue key="water">Eau</enumerationValue>
                        <enumerationValue key="air">Air</enumerationValue>
                        <enumerationValue key="IPE">IPE</enumerationValue>
                    </enumerationValues>
                </property>

            </propertyGroup>

            <!-- IPE Principal (toujours visible) -->
            <propertyGroup caption="Source de données">
                <property key="consumptionDataSource" type="datasource" isList="true" required="false">
                    <caption>Source de données de consommation</caption>
                    <description>Sélectionner la source de données pour la consommation (non requis si le mode dev est activé)</description>
                </property>
                <property key="timestampAttr" type="attribute" dataSource="consumptionDataSource" required="false">
                    <caption>Attribut timestamp</caption>
                    <description>Sélectionner l'attribut timestamp (non requis si le mode dev est activé)</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
                <property key="consumptionAttr" type="attribute" dataSource="consumptionDataSource" required="false">
                    <caption>Attribut consommation</caption>
                    <description>Sélectionner l'attribut de consommation (non requis si le mode dev est activé)</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
                <property key="NameAttr" type="attribute" dataSource="consumptionDataSource" required="false">
                    <caption>Nom de l'objet</caption>
                    <description>Nom de l'objet (non requis si le mode dev est activé)</description>
                    <attributeTypes>
                        <attributeType name="String"/>
                    </attributeTypes>
                </property>
                <property key="metricTypeAttr" type="attribute" dataSource="consumptionDataSource" required="false">
                    <caption>Type de métrique</caption>
                    <description>Attribut MetricType pour identifier le type de variable (Conso, IPE, IPE_kg, Prod, etc.)</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="energyTypeAttr" type="attribute" dataSource="consumptionDataSource" required="false">
                    <caption>Type d'énergie</caption>
                    <description>Attribut EnergyType pour identifier le type d'énergie (Elec, Gaz, Eau, Air, None)</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Période d'analyse">
                <property key="startDate" type="attribute" required="false">
                    <caption>Date de début</caption>
                    <description>Sélectionner la date de début (non requis si le mode dev est activé)</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
                <property key="endDate" type="attribute" required="false">
                    <caption>Date de fin</caption>
                    <description>Sélectionner la date de fin (non requis si le mode dev est activé)</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE - Card 1">
                <property key="card1Title" type="string" required="false">
                    <caption>Titre Card 1</caption>
                    <description>Titre pour la première card</description>
                </property>
                <property key="card1Icon" type="icon" required="false">
                    <caption>Icône Card 1</caption>
                    <description>Sélectionner l'icône pour la première card</description>
                </property>
                <property key="card1Unit" type="string" required="false">
                    <caption>Unité Card 1</caption>
                    <description>Unité pour la première card (ex: kWh, m³, %)</description>
                </property>
                <property key="card1DataSource" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 1</caption>
                    <description>Sélectionner la source de données pour la première card</description>
                </property>
                <property key="card1ValueAttr" type="attribute" dataSource="card1DataSource" required="false">
                    <caption>Attribut valeur Card 1</caption>
                    <description>Sélectionner l'attribut de valeur pour la première card</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE - Card 2">
                <property key="card2Title" type="string" required="false">
                    <caption>Titre Card 2</caption>
                    <description>Titre pour la deuxième card</description>
                </property>
                <property key="card2Icon" type="icon" required="false">
                    <caption>Icône Card 2</caption>
                    <description>Sélectionner l'icône pour la deuxième card</description>
                </property>
                <property key="card2Unit" type="string" required="false">
                    <caption>Unité Card 2</caption>
                    <description>Unité pour la deuxième card (ex: kWh, m³, %)</description>
                </property>
                <property key="card2DataSource" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 2</caption>
                    <description>Sélectionner la source de données pour la deuxième card</description>
                </property>
                <property key="card2ValueAttr" type="attribute" dataSource="card2DataSource" required="false">
                    <caption>Attribut valeur Card 2</caption>
                    <description>Sélectionner l'attribut de valeur pour la deuxième card</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE - Card 3">
                <property key="card3Title" type="string" required="false">
                    <caption>Titre Card 3</caption>
                    <description>Titre pour la troisième card</description>
                </property>
                <property key="card3Icon" type="icon" required="false">
                    <caption>Icône Card 3</caption>
                    <description>Sélectionner l'icône pour la troisième card</description>
                </property>
                <property key="card3Unit" type="string" required="false">
                    <caption>Unité Card 3</caption>
                    <description>Unité pour la troisième card (ex: kWh, m³, %)</description>
                </property>
                <property key="card3DataSource" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 3</caption>
                    <description>Sélectionner la source de données pour la troisième card</description>
                </property>
                <property key="card3ValueAttr" type="attribute" dataSource="card3DataSource" required="false">
                    <caption>Attribut valeur Card 3</caption>
                    <description>Sélectionner l'attribut de valeur pour la troisième card</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <!-- IPE Secondaire (visible seulement en mode double) -->
            <propertyGroup caption="Source de données 2">
                <property key="consumptionDataSource2" type="datasource" isList="true" required="false">
                    <caption>Source de données de consommation 2</caption>
                    <description>Sélectionner la source de données pour la consommation du deuxième IPE</description>
                </property>
                <property key="timestampAttr2" type="attribute" dataSource="consumptionDataSource2" required="false">
                    <caption>Attribut timestamp 2</caption>
                    <description>Sélectionner l'attribut timestamp pour le deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
                <property key="consumptionAttr2" type="attribute" dataSource="consumptionDataSource2" required="false">
                    <caption>Attribut consommation 2</caption>
                    <description>Sélectionner l'attribut de consommation pour le deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
                <property key="NameAttr2" type="attribute" dataSource="consumptionDataSource2" required="false">
                    <caption>Nom de l'objet 2</caption>
                    <description>Nom de l'objet pour le deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="String"/>
                    </attributeTypes>
                </property>
                <property key="metricTypeAttr2" type="attribute" dataSource="consumptionDataSource2" required="false">
                    <caption>Type de métrique 2</caption>
                    <description>Attribut MetricType pour le deuxième IPE (Conso, IPE, IPE_kg, Prod, etc.)</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="energyTypeAttr2" type="attribute" dataSource="consumptionDataSource2" required="false">
                    <caption>Type d'énergie 2</caption>
                    <description>Attribut EnergyType pour le deuxième IPE (Elec, Gaz, Eau, Air, None)</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Période d'analyse 2">
                <property key="startDate2" type="attribute" required="false">
                    <caption>Date de début 2</caption>
                    <description>Sélectionner la date de début pour le deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
                <property key="endDate2" type="attribute" required="false">
                    <caption>Date de fin 2</caption>
                    <description>Sélectionner la date de fin pour le deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="DateTime"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE 2 - Card 1">
                <property key="card1Title2" type="string" required="false">
                    <caption>Titre Card 1 (IPE 2)</caption>
                    <description>Titre pour la première card du deuxième IPE</description>
                </property>
                <property key="card1Icon2" type="icon" required="false">
                    <caption>Icône Card 1 (IPE 2)</caption>
                    <description>Sélectionner l'icône pour la première card du deuxième IPE</description>
                </property>
                <property key="card1Unit2" type="string" required="false">
                    <caption>Unité Card 1 (IPE 2)</caption>
                    <description>Unité pour la première card du deuxième IPE (ex: kWh, m³, %)</description>
                </property>
                <property key="card1DataSource2" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 1 (IPE 2)</caption>
                    <description>Sélectionner la source de données pour la première card du deuxième IPE</description>
                </property>
                <property key="card1ValueAttr2" type="attribute" dataSource="card1DataSource2" required="false">
                    <caption>Attribut valeur Card 1 (IPE 2)</caption>
                    <description>Sélectionner l'attribut de valeur pour la première card du deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE 2 - Card 2">
                <property key="card2Title2" type="string" required="false">
                    <caption>Titre Card 2 (IPE 2)</caption>
                    <description>Titre pour la deuxième card du deuxième IPE</description>
                </property>
                <property key="card2Icon2" type="icon" required="false">
                    <caption>Icône Card 2 (IPE 2)</caption>
                    <description>Sélectionner l'icône pour la deuxième card du deuxième IPE</description>
                </property>
                <property key="card2Unit2" type="string" required="false">
                    <caption>Unité Card 2 (IPE 2)</caption>
                    <description>Unité pour la deuxième card du deuxième IPE (ex: kWh, m³, %)</description>
                </property>
                <property key="card2DataSource2" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 2 (IPE 2)</caption>
                    <description>Sélectionner la source de données pour la deuxième card du deuxième IPE</description>
                </property>
                <property key="card2ValueAttr2" type="attribute" dataSource="card2DataSource2" required="false">
                    <caption>Attribut valeur Card 2 (IPE 2)</caption>
                    <description>Sélectionner l'attribut de valeur pour la deuxième card du deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Configuration IPE 2 - Card 3">
                <property key="card3Title2" type="string" required="false">
                    <caption>Titre Card 3 (IPE 2)</caption>
                    <description>Titre pour la troisième card du deuxième IPE</description>
                </property>
                <property key="card3Icon2" type="icon" required="false">
                    <caption>Icône Card 3 (IPE 2)</caption>
                    <description>Sélectionner l'icône pour la troisième card du deuxième IPE</description>
                </property>
                <property key="card3Unit2" type="string" required="false">
                    <caption>Unité Card 3 (IPE 2)</caption>
                    <description>Unité pour la troisième card du deuxième IPE (ex: kWh, m³, %)</description>
                </property>
                <property key="card3DataSource2" type="datasource" isList="true" required="false">
                    <caption>Source de données Card 3 (IPE 2)</caption>
                    <description>Sélectionner la source de données pour la troisième card du deuxième IPE</description>
                </property>
                <property key="card3ValueAttr2" type="attribute" dataSource="card3DataSource2" required="false">
                    <caption>Attribut valeur Card 3 (IPE 2)</caption>
                    <description>Sélectionner l'attribut de valeur pour la troisième card du deuxième IPE</description>
                    <attributeTypes>
                        <attributeType name="Decimal"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <!-- Noms des IPE -->
            <propertyGroup caption="Noms des IPE">
                <property key="ipe1Name" type="string" required="false">
                    <caption>Nom IPE 1</caption>
                    <description>Nom personnalisé pour le premier IPE</description>
                </property>
                <property key="ipe2Name" type="string" required="false">
                    <caption>Nom IPE 2</caption>
                    <description>Nom personnalisé pour le deuxième IPE</description>
                </property>
            </propertyGroup>


            <!-- ==================== Granularité ==================== -->
            <propertyGroup caption="Affichage Granularité (Lecture)">
                <property key="displayModeAttr" type="attribute" required="false">
                    <caption>Attribut Mode (Lecture)</caption>
                    <description>Attribut pour le mode (Auto/Strict).</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="displayTimeAttr" type="attribute" required="false">
                    <caption>Attribut Time (Lecture)</caption>
                    <description>Attribut pour la valeur de temps.</description>
                    <attributeTypes>
                        <attributeType name="Integer"/>
                    </attributeTypes>
                </property>
                <property key="displayUnitAttr" type="attribute" required="false">
                    <caption>Attribut Unit (Lecture)</caption>
                    <description>Attribut pour l'unité de temps.</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="displayPreviewOKAttr" type="attribute" required="false">
                    <caption>Attribut Preview OK (Lecture)</caption>
                    <description>Attribut booléen indiquant si la configuration est valide.</description>
                    <attributeTypes>
                        <attributeType name="Boolean"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <propertyGroup caption="Buffer Granularité (Écriture)">
                <property key="bufferModeAttr" type="attribute" required="false">
                    <caption>Attribut Mode (Écriture)</caption>
                    <description>Attribut pour stocker le changement de mode.</description>
                     <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="bufferTimeAttr" type="attribute" required="false">
                    <caption>Attribut Time (Écriture)</caption>
                    <description>Attribut pour stocker le changement de valeur.</description>
                     <attributeTypes>
                        <attributeType name="Integer"/>
                    </attributeTypes>
                </property>
                <property key="bufferUnitAttr" type="attribute" required="false">
                    <caption>Attribut Unit (Écriture)</caption>
                    <description>Attribut pour stocker le changement d'unité.</description>
                     <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="onModeChange" type="action" required="false">
                    <caption>On Mode Change</caption>
                    <description>Microflow à exécuter quand le mode change.</description>
                </property>
                <property key="onTimeChange" type="action" required="false">
                    <caption>On Time/Unit Change</caption>
                    <description>Microflow à exécuter quand la valeur ou l'unité change.</description>
                </property>
            </propertyGroup>

            <!-- ==================== Feature Toggles ==================== -->
            <propertyGroup caption="Feature Toggles">
                <property key="featureList" type="datasource" isList="true" required="false">
                    <caption>FeatureToggle – liste activée</caption>
                    <description>Liste des features activées pour ce widget</description>
                </property>
                <property key="featureNameAttr" type="attribute" dataSource="featureList" required="false">
                    <caption>Attribut FeatureName</caption>
                    <description>Attribut contenant le nom de la feature</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
            </propertyGroup>

            <!-- ==================== Variables de l'Asset ==================== -->
            <propertyGroup caption="Variables de l'Asset">
                <property key="assetVariablesDataSource" type="datasource" isList="true" required="false">
                    <caption>Variables de l'asset</caption>
                    <description>Liste des variables de l'asset sélectionné pour récupérer les unités automatiquement</description>
                </property>
                <property key="variableNameAttr" type="attribute" dataSource="assetVariablesDataSource" required="false">
                    <caption>Attribut Nom Variable</caption>
                    <description>Attribut contenant le nom de la variable</description>
                    <attributeTypes>
                        <attributeType name="String"/>
                    </attributeTypes>
                </property>
                <property key="variableUnitAttr" type="attribute" dataSource="assetVariablesDataSource" required="false">
                    <caption>Attribut Unité Variable</caption>
                    <description>Attribut contenant l'unité de la variable</description>
                    <attributeTypes>
                        <attributeType name="String"/>
                    </attributeTypes>
                </property>
                <property key="variableMetricTypeAttr" type="attribute" dataSource="assetVariablesDataSource" required="false">
                    <caption>Attribut Type Métrique Variable</caption>
                    <description>Attribut contenant le type de métrique de la variable</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
                <property key="variableEnergyTypeAttr" type="attribute" dataSource="assetVariablesDataSource" required="false">
                    <caption>Attribut Type Énergie Variable</caption>
                    <description>Attribut contenant le type d'énergie de la variable</description>
                    <attributeTypes>
                        <attributeType name="Enum"/>
                    </attributeTypes>
                </property>
            </propertyGroup>
        </propertyGroup>
    </properties>
</widget>